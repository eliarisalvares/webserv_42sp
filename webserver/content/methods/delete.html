<!DOCTYPE html>
<html lang="en">
<body>
    <h1>Escolha o arquivo que deseja deletar</h1>
    <h2>Arquivos dispon√≠veis:</h2>
    <lu></lu>
    <script>
        const fileList = document.querySelector('lu');
        const request = new XMLHttpRequest();
        request.open('GET', 'http://localhost:8080/upload/listing.json');
        request.send();
        request.onload = () => {
            let files = JSON.parse(request.response);
            console.log(files);
            files = files.files;
            files.forEach(file => {
                if (file === '.' || file === '..' || file === 'listing.json') {
                    return;
                }
                const li = document.createElement('li');
                li.textContent = file;
    
                const button = document.createElement('button');
                button.type = 'button';
                button.style.marginLeft = '1rem';
                button.textContent = 'Delete';
                button.addEventListener('click', () => {
                    const request = new XMLHttpRequest();
                    request.open('DELETE', `http://localhost:8080/upload/${file}`);
                    request.send();
                    request.onload = () => {
                        if (request.status === 200) {
                            alert('File deleted successfully!');
                            location.reload();
                        } else {
                            alert('Something went wrong!');
                        }
                    };
                });
                li.style.marginBottom = '1rem';
                li.appendChild(button);
                fileList.appendChild(li);
            });
        };
    </script>
</body>